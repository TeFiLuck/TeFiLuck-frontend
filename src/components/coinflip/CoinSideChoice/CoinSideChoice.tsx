import { BoxStyled } from '@/components/styleds';
import { CoinSide, DEFAULT_SELECTED_SIDE } from '@/constants/coinflip';
import { BaseSize } from '@/typings/app';
import { Space } from 'antd';
import { FC, useEffect, useState } from 'react';
import styled from 'styled-components';

export interface CoinSideChoiceProps {
  side?: CoinSide;
  size?: BaseSize;
  onSideChange?: (side: CoinSide) => void;
}

const CoinSideChoice: FC<CoinSideChoiceProps> = ({
  side = DEFAULT_SELECTED_SIDE,
  size = 'medium',
  onSideChange = () => {},
}) => {
  const [selectedCoinSide, setSelectedCoinSide] = useState<CoinSide>(side);

  useEffect(() => {
    setSelectedCoinSide(side);
  }, [side]);

  useEffect(() => {
    if (selectedCoinSide !== side) onSideChange(selectedCoinSide);
  }, [selectedCoinSide]);

  return (
    <WrapperStyled size={size}>
      <ContentStyled>
        <div className="choice-label">Side:</div>

        <Space size={8}>
          <CoinStyled active={selectedCoinSide === CoinSide.Heads} onClick={() => setSelectedCoinSide(CoinSide.Heads)}>
            <svg viewBox="0 0 128 128" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="64" cy="64" r="64" fill="#0094FF" />
              <path
                d="M108.885 43.5328C110.072 32.0226 101.797 25.8649 97.2551 24.2171C96.2481 23.8508 95.0077 24.1901 94.5093 25.1396C94.0229 26.0656 94.1658 27.1126 94.9837 27.7405C95.22 28.1175 96.3167 30.198 96.0186 35.9397C95.9633 37.0033 95.8162 39.8289 90.0445 39.8293C89.4132 39.8293 88.8329 39.7907 88.3589 39.744C87.9481 38.8866 87.2747 37.7633 86.2458 36.2009C84.5362 33.6048 81.8569 32.2327 78.4969 32.2327C76.5536 32.2327 74.3701 32.729 72.5061 33.5945C70.513 34.52 65.8466 35.0729 63.9994 35.229C62.1521 35.0733 57.4861 34.5205 55.4931 33.5945C53.6291 32.729 51.4456 32.2327 49.5022 32.2327C46.1423 32.2327 43.4629 33.6048 41.7534 36.2009C40.7249 37.7633 40.0511 38.8866 39.6402 39.7436C39.1663 39.7907 38.5855 39.8293 37.9542 39.8293C32.183 39.8293 32.0359 37.0033 31.9805 35.9397C31.6825 30.198 32.7791 28.1175 33.0155 27.7405C33.8334 27.1121 33.9762 26.0656 33.4898 25.1396C32.9915 24.1905 31.7519 23.8508 30.744 24.2171C26.2029 25.8649 17.9278 32.023 19.1154 43.5333C19.9376 51.4996 23.4974 54.7026 26.5409 55.9695C24.076 58.3285 21.4314 61.4843 21.3551 64.2202C21.3027 66.1057 21.796 67.5961 22.821 68.6499C23.9061 69.7659 25.4725 70.308 27.6084 70.308C28.5798 70.308 29.695 70.1982 31.0177 69.973C34.0525 69.457 37.0514 68.7129 38.9334 68.2098C39.9271 70.9123 41.8263 75.9214 43.4509 79.3191C45.1794 82.9338 46.0239 86.335 46.2692 87.4299C45.9441 89.4102 45.1271 96.4072 48.9833 100.263C52.0109 103.291 57.9828 103.927 62.4596 103.927C63.2153 103.927 63.7652 103.905 63.9998 103.894C64.2348 103.905 64.7847 103.927 65.54 103.927C70.0168 103.927 75.9891 103.291 79.0167 100.263C82.8729 96.4072 82.0559 89.4106 81.7308 87.4299C81.9765 86.3328 82.8206 82.933 84.5491 79.3191C86.1737 75.9214 88.0729 70.9119 89.0666 68.2098C90.9486 68.7129 93.9475 69.4566 96.9823 69.973C98.305 70.1982 99.4206 70.308 100.392 70.308C102.528 70.308 104.094 69.7654 105.179 68.6499C106.204 67.5961 106.697 66.1057 106.645 64.2198C106.569 61.4843 103.924 58.3285 101.459 55.9695C104.503 54.7026 108.062 51.5 108.885 43.5328ZM44.3255 62.5655C44.3255 60.7946 45.1236 59.1468 46.5154 58.0446C47.3256 57.4021 48.4789 57.4304 49.2586 58.1106L54.6203 62.7976C55.3987 63.4787 55.5806 64.6182 55.0526 65.5073C54.0164 67.2508 52.1164 68.3342 50.0941 68.3342C46.9134 68.3346 44.3255 65.7462 44.3255 62.5655ZM55.228 97.9778C54.8424 98.1279 54.4375 98.2038 54.0254 98.2038C52.0567 98.2038 50.3373 96.4925 49.7467 93.9449C49.0682 91.0181 50.0881 88.3062 52.1717 87.4969C52.5581 87.3463 52.963 87.2708 53.3743 87.2708C55.3429 87.2708 57.0624 88.9821 57.653 91.5293C58.3315 94.4565 57.3116 97.1685 55.228 97.9778ZM78.3155 93.9453C77.7249 96.4921 76.0054 98.2042 74.0368 98.2042C74.0368 98.2042 74.0368 98.2042 74.0364 98.2042C73.6246 98.2038 73.2202 98.1279 72.8338 97.9778C70.7506 97.1689 69.7307 94.457 70.4092 91.5298C70.9998 88.983 72.7192 87.2713 74.6879 87.2713C75.0992 87.2713 75.5036 87.3472 75.8901 87.4969C77.9741 88.3062 78.994 91.0181 78.3155 93.9453ZM77.9059 68.3346C75.8836 68.3346 73.9836 67.2517 72.9474 65.5078C72.4194 64.6187 72.6009 63.4791 73.3797 62.798L78.7414 58.111C79.5207 57.4308 80.674 57.4025 81.4846 58.045C82.8764 59.1472 83.6745 60.7951 83.6745 62.566C83.6745 65.7462 81.0866 68.3346 77.9059 68.3346Z"
                fill="black"
              />
            </svg>
          </CoinStyled>

          <CoinStyled active={selectedCoinSide === CoinSide.Tails} onClick={() => setSelectedCoinSide(CoinSide.Tails)}>
            <svg viewBox="0 0 128 128" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="64" cy="64" r="64" fill="#EA4242" />
              <path
                d="M66.3522 81.5867V85.2947L71.9044 88.482C73.0311 89.1289 73.4202 90.5665 72.7733 91.6928C72.3386 92.4502 71.5464 92.8746 70.7311 92.8746C70.3341 92.8746 69.9314 92.7739 69.5625 92.5617L64.0005 89.3683L58.4379 92.5617C58.0691 92.7739 57.6659 92.8746 57.2693 92.8746C56.4545 92.8746 55.6618 92.4507 55.2271 91.6928C54.5803 90.5661 54.9693 89.1284 56.096 88.482L61.6487 85.2947V81.5867C61.4751 81.4625 61.3076 81.3279 61.1529 81.1755L54.3883 74.5211C53.2084 73.36 52.8509 71.6203 53.478 70.0881C54.1051 68.5558 55.5804 67.566 57.2355 67.566H70.765C72.4205 67.566 73.8954 68.5558 74.5225 70.0881C75.1496 71.6203 74.792 73.36 73.6117 74.5211L66.8476 81.176C66.6928 81.3284 66.5258 81.463 66.3522 81.5867ZM102.047 47.8816C104.642 54.6283 112.808 78.47 103.551 89.9606C94.594 101.081 79.9213 104.926 73.6559 106.568C72.6924 106.82 71.8607 107.038 71.3531 107.203C67.0452 108.605 64.2987 108.645 63.9995 108.645C63.7003 108.645 60.9534 108.604 56.6451 107.203C56.1384 107.038 55.3062 106.82 54.3427 106.568C48.0773 104.926 33.4046 101.081 24.4473 89.9606C15.1903 78.4695 23.3568 54.6283 25.9518 47.8816C23.4372 45.9269 19 41.6092 19 35.4731C19 27.4892 25.7547 19.3547 32.3846 19.3547C32.4726 19.3547 32.5601 19.3561 32.6481 19.3594C37.0284 19.5105 40.6814 24.0879 42.6004 27.062C44.1919 26.0393 46.4434 24.9653 48.878 24.9653H79.122C81.5566 24.9653 83.8081 26.0393 85.3996 27.062C87.3186 24.0879 90.9721 19.5105 95.3524 19.3594C95.4408 19.3561 95.5274 19.3547 95.6158 19.3547C102.245 19.3547 109 27.4892 109 35.4731C109 41.6092 104.563 45.9269 102.047 47.8816ZM48.5125 60.1668C51.6103 60.1668 54.3267 58.0738 55.1189 55.0766C55.381 54.0868 54.9717 53.0405 54.1075 52.491L46.8974 47.9051C46.0313 47.3542 44.9103 47.4286 44.1241 48.0867C42.567 49.3908 41.6745 51.3018 41.6745 53.3294C41.6745 57.0995 44.7423 60.1668 48.5125 60.1668ZM80.4599 79.8851C80.4599 73.3238 77.5441 67.8294 71.7934 63.5545C69.5287 61.8713 66.8335 60.9812 64.0005 60.9812C61.167 60.9812 58.4718 61.8713 56.2071 63.5545C50.4563 67.8294 47.5405 73.3238 47.5405 79.8851C47.5405 90.0754 54.6325 94.4331 60.5822 96.2942C62.799 96.9872 65.202 96.9872 67.4187 96.2942C73.3675 94.4331 80.4599 90.0759 80.4599 79.8851ZM86.3255 53.3289C86.3255 51.3013 85.433 49.3908 83.8759 48.0863C83.0897 47.4281 81.9677 47.3533 81.1026 47.9047L73.8925 52.4906C73.0283 53.0401 72.619 54.0863 72.8811 55.0761C73.6733 58.0733 76.3897 60.1664 79.4875 60.1664C83.2582 60.1668 86.3255 57.0995 86.3255 53.3289Z"
                fill="black"
              />
            </svg>
          </CoinStyled>
        </Space>
      </ContentStyled>
    </WrapperStyled>
  );
};

export default CoinSideChoice;

const WrapperStyled = styled(BoxStyled)`
  display: flex;
  padding: 0 12px;
  align-items: center;
  justify-content: center;
`;

const ContentStyled = styled.div`
  display: flex;
  align-items: center;

  .choice-label {
    margin-right: 14px;
    user-select: none;
  }
`;

const CoinStyled = styled.div<{
  active: boolean;
}>`
  display: flex;
  justify-content: center;
  align-items: center;
  border-radius: 50%;
  box-sizing: border-box;
  width: 24px;
  height: 24px;
  transition: 0.2s all;

  svg {
    width: 100%;
    height: 100%;
  }

  ${({ active }) =>
    active
      ? `
    box-shadow: 0px 0px 4px 4px rgba(192,0,255,0.35);
  `
      : `
    opacity: 0.2;
    cursor: pointer;

    &:hover {
      opacity: 0.75;
    }
  `}
`;
